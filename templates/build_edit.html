{% extends "base.html" %}

{% block title %}Edit Build - Wheel Builder{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header" style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; padding: 2rem 0; margin-bottom: 2rem;">
    <div class="container">
        <h1 class="mb-0"><i class="bi bi-pencil"></i> Edit Build</h1>
        <p class="mb-0 mt-2 opacity-75">Update build components and details</p>
    </div>
</div>

<div class="container pb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-body p-4">
                    <form method="POST" action="/build/{{ build.id }}/update">
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label for="name" class="form-label">Build Name *</label>
                                <input type="text" class="form-control" id="name" name="name" required
                                       value="{{ build.name }}" placeholder="e.g., Commuter Primary - Rear">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="hub_id" class="form-label">Hub</label>
                                <select class="form-select" id="hub_id" name="hub_id">
                                    <option value="">Select hub...</option>
                                    {% for hub in hubs %}
                                    <option value="{{ hub.id }}" {% if build.hub_id == hub.id %}selected{% endif %}>
                                        {{ hub.make }} {{ hub.model }} ({{ hub.type }})
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="rim_id" class="form-label">Rim</label>
                                <select class="form-select" id="rim_id" name="rim_id">
                                    <option value="">Select rim...</option>
                                    {% for rim in rims %}
                                    <option value="{{ rim.id }}" {% if build.rim_id == rim.id %}selected{% endif %}>
                                        {{ rim.make }} {{ rim.model }} ({{ rim.holes }} holes)
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="spoke_left_id" class="form-label">Spoke Left</label>
                                <select class="form-select" id="spoke_left_id" name="spoke_left_id">
                                    <option value="">Select spoke...</option>
                                    {% for spoke in spokes %}
                                    <option value="{{ spoke.id }}" {% if build.spoke_left_id == spoke.id %}selected{% endif %}>
                                        {{ spoke.spoke_type.name }} - {{ spoke.length }}mm
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="spoke_right_id" class="form-label">Spoke Right</label>
                                <select class="form-select" id="spoke_right_id" name="spoke_right_id">
                                    <option value="">Select spoke...</option>
                                    {% for spoke in spokes %}
                                    <option value="{{ spoke.id }}" {% if build.spoke_right_id == spoke.id %}selected{% endif %}>
                                        {{ spoke.spoke_type.name }} - {{ spoke.length }}mm
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="nipple_id" class="form-label">Nipple</label>
                                <select class="form-select" id="nipple_id" name="nipple_id">
                                    <option value="">Select nipple...</option>
                                    {% for nipple in nipples %}
                                    <option value="{{ nipple.id }}" {% if build.nipple_id == nipple.id %}selected{% endif %}>
                                        {{ nipple.material }} {{ nipple.diameter }}mm {{ nipple.color }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="lacing_pattern" class="form-label">Lacing Pattern</label>
                                <select class="form-select" id="lacing_pattern" name="lacing_pattern">
                                    <option value="">Select pattern...</option>
                                    <option value="radial" {% if build.lacing_pattern == 'radial' %}selected{% endif %}>Radial</option>
                                    <option value="1-cross" {% if build.lacing_pattern == '1-cross' %}selected{% endif %}>1-cross</option>
                                    <option value="2-cross" {% if build.lacing_pattern == '2-cross' %}selected{% endif %}>2-cross</option>
                                    <option value="3-cross" {% if build.lacing_pattern == '3-cross' %}selected{% endif %}>3-cross</option>
                                    <option value="4-cross" {% if build.lacing_pattern == '4-cross' %}selected{% endif %}>4-cross</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="spoke_count" class="form-label">Spoke Count</label>
                                <select class="form-select" id="spoke_count" name="spoke_count">
                                    <option value="">Select count...</option>
                                    <option value="24" {% if build.spoke_count == 24 %}selected{% endif %}>24</option>
                                    <option value="28" {% if build.spoke_count == 28 %}selected{% endif %}>28</option>
                                    <option value="32" {% if build.spoke_count == 32 %}selected{% endif %}>32</option>
                                    <option value="36" {% if build.spoke_count == 36 %}selected{% endif %}>36</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="status" class="form-label">Status</label>
                                <select class="form-select" id="status" name="status">
                                    <option value="draft" {% if build.status == 'draft' %}selected{% endif %}>Draft</option>
                                    <option value="in_progress" {% if build.status == 'in_progress' %}selected{% endif %}>In Progress</option>
                                    <option value="completed" {% if build.status == 'completed' %}selected{% endif %}>Completed</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="comments" class="form-label">Comments</label>
                            <textarea class="form-control" id="comments" name="comments" rows="3"
                                      placeholder="Optional notes about this build...">{{ build.comments|default('', true) }}</textarea>
                        </div>

                        <div class="d-flex gap-2 justify-content-end">
                            <a href="/build/{{ build.id }}" class="btn btn-secondary">
                                <i class="bi bi-x-lg"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-lg"></i> Update Build
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
